<!-- checkout.component.html -->
<div class="checkout-container">
  <div class="checkout-header">
    <h1>Checkout</h1>
    <div class="checkout-steps">
      <div class="step" [class.active]="currentStep === 1">
        <div class="step-number" [class.active]="currentStep === 1" [class.completed]="currentStep > 1">1</div>
        <div class="step-label" [class.active]="currentStep === 1">Shipping</div>
      </div>
      <div class="step" [class.active]="currentStep === 2">
        <div class="step-number" [class.active]="currentStep === 2" [class.completed]="currentStep > 2">2</div>
        <div class="step-label" [class.active]="currentStep === 2">Payment</div>
      </div>
      <div class="step" [class.active]="currentStep === 3">
        <div class="step-number" [class.active]="currentStep === 3">3</div>
        <div class="step-label" [class.active]="currentStep === 3">Confirmation</div>
      </div>
    </div>
  </div>

  <div class="checkout-content">
    <form [formGroup]="checkoutForm" (ngSubmit)="onSubmit()" class="checkout-form">
      <!-- Step 1: Shipping Information -->
      <div class="form-section" *ngIf="currentStep === 1" formGroupName="shippingInfo">
        <h2>Shipping Information</h2>
        <div class="form-group">
          <label for="address">Delivery Address</label>
          <input 
            id="address"
            type="text"
            formControlName="address"
            placeholder="Enter your delivery address"
          >
          <div class="error-message" *ngIf="checkoutForm.get('shippingInfo.address')?.errors?.['required'] && 
                                          checkoutForm.get('shippingInfo.address')?.touched">
            Address is required
          </div>
        </div>

        <div class="form-group">
          <label for="phone">Phone Number</label>
          <input 
            id="phone"
            type="tel"
            formControlName="phone"
            placeholder="Enter your phone number"
          >
          <div class="error-message" *ngIf="checkoutForm.get('shippingInfo.phone')?.errors?.['required'] && 
                                          checkoutForm.get('shippingInfo.phone')?.touched">
            Phone number is required
          </div>
          <div class="error-message" *ngIf="checkoutForm.get('shippingInfo.phone')?.errors?.['pattern'] && 
                                          checkoutForm.get('shippingInfo.phone')?.touched">
            Please enter a valid 10-digit phone number
          </div>
        </div>

        <div class="form-group">
          <label for="note">Order Notes (Optional)</label>
          <textarea 
            id="note"
            formControlName="note"
            rows="3"
            placeholder="Any special instructions for delivery?"
          ></textarea>
        </div>
      </div>

      <!-- Step 2: Payment Method -->
      <div class="form-section" *ngIf="currentStep === 2" formGroupName="paymentInfo">
        <h2>Payment Method</h2>
        <div class="payment-methods">
          <div 
            *ngFor="let method of paymentMethods"
            class="payment-method"
            [class.selected]="checkoutForm.get('paymentInfo.paymentMethodId')?.value === method.id"
            (click)="checkoutForm.get('paymentInfo.paymentMethodId')?.setValue(method.id)"
          >
            <div class="method-name">{{ method.name }}</div>
            <div class="method-description">{{ method.description }}</div>
          </div>
        </div>
        <div class="error-message" *ngIf="checkoutForm.get('paymentInfo.paymentMethodId')?.errors?.['required'] && 
                                        checkoutForm.get('paymentInfo.paymentMethodId')?.touched">
          Please select a payment method
        </div>
      </div>

      <!-- Step 3: Confirmation -->